import pandas as pd
import numpy as np

# Dados da tabela com colunas renomeadas para evitar duplicidade
data_3900K = {
    "Element": ["Fe", "FeH", "C", "H2O", "OH", "Na", "Mg", "Al", "Si", "K", "Ca", "Ti", "V", "Cr", "Mn", "Ni"],
    "+100_Teff":[-0.17, 0.03, 0.06, 0.10, 0.00, -0.20, -0.30, -0.08, -0.24, 0.00, -0.03, -0.01, 0.04, -0.11, -0.14, -0.06],
    "+50_Teff":[-0.09, 0.01, 0.00, 0.07, 0.00, -0.02, -0.14, -0.03, -0.13, -0.01, -0.02, 0.00, 0.02, -0.06, -0.07, -0.01],
    "-50_Teff":[0.09, -0.01, 0.00, -0.02, -0.01, 0.00, 0.12, 0.04, 0.12, 0.00, 0.01, 0.02, -0.01, 0.08, 0.08, 0.21],
    "-100_Teff":[0.18, -0.03, 0.00, -0.04, -0.01, -0.01, 0.22, 0.06, 0.22, 0.01, 0.02, 0.02, -0.03, 0.15, 0.16, 0.26],
    "+0.20_logg":[0.18, 0.05, 0.03, 0.00, 0.02, 0.15, 0.17, 0.06, 0.21, 0.05, 0.09, 0.09, 0.13, 0.17, 0.17, 0.43],
    "+0.10_logg":[0.09, 0.03, 0.02, 0.00, 0.01, 0.06, 0.09, 0.04, 0.11, 0.02, 0.05, 0.05, 0.08, 0.09, 0.09, 0.29],
    "-0.10_logg":[-0.09, -0.03, -0.01, 0.00, -0.02, -0.04, -0.11, -0.04, -0.12, -0.03, -0.06, -0.04, -0.04, -0.08, -0.08, -0.14],
    "-0.20_logg":[-0.17, -0.05, -0.01, 0.00, -0.06, -0.27, -0.24, -0.09, -0.23, -0.06, -0.13, -0.08, -0.08, -0.13, -0.15, -0.27],
    "+0.20_FeH":[-0.01, 0.09, 0.18, 0.20, 0.05, -0.13, -0.11, -0.03, -0.05, -0.02, -0.08, 0.02, 0.09, 0.01, 0.01, -0.15],
    "+0.10_FeH":[-0.01, 0.04, 0.09, 0.14, 0.00, -0.18, -0.05, -0.01, -0.03, -0.02, -0.04, 0.01, 0.03, -0.01, -0.01, -0.08],
    "-0.10_FeH":[0.03, -0.05, -0.07, -0.10, -0.09, 0.07, 0.03, 0.00, 0.03, 0.02, 0.03, 0.01, 0.02, 0.06, 0.04, 0.27],
    "-0.20_FeH":[0.05, -0.10, 0.02, -0.21, -0.17, 0.11, 0.03, -0.01, 0.04, 0.04, 0.07, 0.00, 0.01, 0.08, 0.07, 0.29],
    "+0.50_xi":[0.00, -0.03, 0.01, 0.00, -0.02, 0.00, 0.00, 0.00, -0.01, -0.01, -0.01, -0.01, 0.00, 0.00, 0.00, -0.01],
    "+0.25_xi":[0.00, -0.01, 0.01, 0.00, -0.01, 0.00, 0.00, 0.00, -0.01, 0.00, -0.01, 0.00, 0.00, 0.00, 0.00, 0.00],
    "-0.25_xi":[0.00, 0.01, 0.00, 0.00, 0.01, 0.01, 0.00, 0.01, 0.00, 0.00, 0.00, 0.01, 0.00, 0.00, 0.00, 0.01],
    "-0.50_xi":[0.00, 0.02, 0.00, 0.00, 0.01, 0.00, 0.00, 0.01, 0.00, 0.00, 0.00, 0.02, 0.00, 0.00, 0.00, 0.01]

}

data_3800K = {
    "Element": ["Fe (Fe I)", "Fe (FeH)", "C", "H2O", "OH", "Na", "Mg", "Al", "Si", "K", "Ca", "Ti", "V", "Cr", "Mn", "Ni"],
    "+100_Teff":[-0.16, 0.04, 0.01, 0.06, 0.00, -0.15, -0.26, -0.10, -0.24, 0.02, -0.03, -0.02, 0.05, -0.10, -0.12, 0.08],
    "+50_Teff":[-0.09, 0.02, 0.01, 0.03, 0.00, -0.13, -0.13, -0.05, -0.12, 0.01, -0.02, -0.02, 0.03, -0.05, -0.07, -0.04],
    "-50_Teff":[0.11, -0.02, -0.07, -0.02, 0.00, 0.06, 0.13, 0.05, 0.15, 0.00, 0.02, 0.01, -0.02, 0.08, 0.09, 0.14],
    "-100_Teff":[0.19, -0.03, -0.07, -0.04, 0.00, 0.07, 0.23, 0.09, 0.27, 0.00, 0.03, 0.02, -0.03, 0.19, 0.16, 0.15],
    "+0.20_logg":[0.19, 0.04, 0.06, 0.00, 0.02, 0.18, 0.17, 0.07, 0.23, 0.04, 0.10, 0.08, 0.13, 0.16, 0.17, 0.35],
    "+0.10_logg":[0.10, 0.02, 0.03, 0.01, 0.01, 0.10, 0.09, 0.04, 0.12, 0.02, 0.05, 0.04, 0.07, 0.09, 0.09, 0.24],
    "-0.10_logg":[-0.09, -0.03, -0.02, 0.01, -0.02, -0.17, -0.10, -0.04, -0.11, -0.03, -0.06, -0.04, -0.04, -0.06, -0.08, -0.19],
    "-0.20_logg":[-0.17, -0.05, -0.05, 0.01, -0.06, -0.20, -0.20, -0.10, -0.22, -0.05, -0.12, -0.08, -0.08, -0.11, -0.15, -0.34],
    "+0.20_FeH":[0.00, 0.10, 0.12, 0.30, 0.06, -0.04, -0.09, -0.03, -0.05, -0.02, -0.08, 0.02, 0.09, 0.03, 0.02, -0.13],
    "+0.10_FeH": [-0.01, 0.05, 0.03, 0.25, 0.00, -0.10, -0.04, -0.01, -0.02, -0.01, -0.03, 0.01, 0.04, 0.01, 0.00, -0.16],
    "-0.10_FeH":[0.04, -0.06, -0.05, -0.10, -0.09, 0.13, 0.04, 0.01, 0.06, 0.02, 0.04, 0.05, 0.02, 0.05, 0.05, 0.25],
    "-0.20_FeH":[0.07, -0.11, -0.13, -0.20, -0.17, 0.14, 0.05, 0.00, 0.09, 0.04, 0.08, 0.08, 0.02, 0.08, 0.08, 0.22],
    "+0.50_xi":[0.00, -0.04, -0.01, 0.01, -0.02, 0.00, 0.00, 0.00, 0.01, 0.00, 0.00, -0.02, 0.00, 0.00, 0.00, -0.11],
    "+0.25_xi":[0.00, -0.02, 0.00, 0.01, -0.01, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, -0.01, 0.00, 0.00, 0.00, -0.07],
    "-0.25_xi":[0.00, 0.01, 0.01, 0.01, 0.01, 0.01, 0.00, 0.01, 0.01, 0.00, 0.00, 0.01, 0.00, 0.00, 0.00, 0.02],
    "-0.50_xi":[0.00, 0.03, 0.00, 0.01, 0.01, 0.00, 0.00, 0.01, 0.01, 0.00, 0.00, 0.02, 0.00, 0.00, 0.00, 0.05]
}

data_3700K = {
    "Element": ["Fe", "FeH", "C", "H2O", "OH", "Na", "Mg", "Al", "Si", "K", "Ca", "Ti", "V", "Cr", "Mn", "Ni"],
    "+100_Teff":     [-0.11, 0.05, 0.02, 0.09, 0.00, 0.01, -0.24, -0.11, -0.27, 0.05, -0.04, -0.02, 0.09, -0.12, -0.08, 0.35],
    "+50_Teff":      [-0.06, 0.02, 0.01, 0.04, 0.00, 0.00, -0.13, -0.05, -0.14, 0.03, -0.01, -0.01, 0.04, -0.06, -0.05, 0.08],
    "-50_Teff":      [0.09, -0.02, -0.01, -0.03, 0.00, -0.01, 0.12, 0.04, 0.13, -0.01, 0.02, 0.01, -0.02, 0.09, 0.06, 0.21],
    "-100_Teff":     [0.20, -0.04, 0.00, -0.06, 0.00, -0.02, 0.22, 0.09, 0.27, -0.01, 0.04, 0.02, -0.03, 0.17, 0.14, 0.23],
    "+0.20_logg":    [0.19, 0.03, 0.04, -0.01, 0.02, 0.12, 0.15, 0.06, 0.23, 0.03, 0.10, 0.07, 0.12, 0.17, 0.16, 0.31],
    "+0.10_logg":    [0.10, 0.01, 0.02, -0.01, 0.01, 0.03, 0.08, 0.03, 0.13, 0.02, 0.05, 0.04, 0.07, 0.09, 0.08, 0.23],
    "-0.10_logg":    [-0.08, -0.02, -0.03, 0.00, -0.01, -0.02, -0.08, -0.04, -0.12, -0.01, -0.06, -0.04, -0.05, -0.07, -0.07, -0.06],
    "-0.20_logg":    [-0.15, -0.04, -0.05, 0.00, -0.04, -0.04, -0.17, -0.09, -0.23, -0.02, -0.12, -0.08, -0.09, -0.12, -0.13, 0.01],
    "+0.20_FeH":     [0.03, 0.11, 0.11, 0.30, 0.06, 0.24, -0.06, -0.03, -0.08, 0.00, 0.03, 0.04, 0.10, 0.03, 0.04, 0.23],
    "+0.10_FeH":     [0.01, 0.05, 0.01, 0.24, 0.01, 0.08, -0.03, -0.01, -0.04, 0.00, 0.00, 0.01, 0.04, 0.01, 0.01, -0.05],
    "-0.10_FeH":     [0.06, -0.06, -0.07, -0.11, -0.08, 0.07, 0.03, 0.00, 0.07, 0.02, 0.04, 0.05, 0.02, 0.06, 0.05, 0.21],
    "-0.20_FeH":     [0.10, -0.12, -0.15, -0.21, -0.17, 0.16, 0.04, -0.01, 0.09, 0.03, 0.08, 0.07, 0.01, 0.07, 0.08, 0.26],
    "+0.50_xi":      [0.00, -0.05, 0.00, 0.11, -0.02, 0.00, 0.00, -0.01, 0.00, 0.00, 0.00, -0.02, 0.00, 0.00, -0.01, 0.00],
    "+0.25_xi":      [0.00, -0.03, 0.00, -0.01, -0.01, 0.00, 0.00, -0.01, 0.00, 0.00, 0.00, -0.01, 0.00, 0.00, 0.00, 0.00],
    "-0.25_xi":      [0.00, 0.02, -0.01, 0.00, 0.01, 0.00, 0.00, 0.01, 0.01, 0.02, 0.00, 0.01, 0.00, 0.00, 0.00, 0.01],
    "-0.50_xi":      [0.00, 0.04, -0.01, 0.00, 0.02, 0.00, 0.00, 0.02, 0.00, 0.01, 0.00, 0.02, 0.00, 0.00, 0.00, 0.01]
}

data_3600K = {
    "Element": ["Fe", "FeH", "C", "H2O", "OH", "Na", "Mg", "Al", "Si", "K", "Ca", "Ti", "V", "Cr", "Mn", "Ni"],
    "+100_Teff":     [-0.12, 0.06, 0.02, 0.08, 0.08, -0.02, -0.21, -0.13, -0.27, 0.06, -0.05, -0.03, 0.10, 0.00, 0.11, 0.11],
    "+50_Teff":      [-0.06, 0.03, 0.01, 0.04, 0.04, -0.01, -0.11, -0.05, -0.13, 0.03, -0.02, -0.01, 0.05, 0.00, 0.05, 0.03],
    "-50_Teff":      [0.08, -0.02, -0.01, -0.03, -0.03, -0.01, 0.11, 0.06, 0.16, -0.01, 0.02, 0.02, -0.02, 0.00, 0.01, 0.01],
    "-100_Teff":     [0.17, -0.03, -0.02, -0.06, -0.06, -0.04, 0.20, 0.10, 0.27, -0.04, 0.04, 0.04, -0.03, 0.00, 0.02, 0.02],
    "+0.20_logg":    [0.18, 0.03, 0.03, -0.01, -0.01, 0.08, 0.13, 0.07, 0.21, 0.00, 0.10, 0.02, 0.11, 0.00, 0.14, 0.14],
    "+0.10_logg":    [0.08, 0.01, 0.02, 0.00, 0.00, 0.02, 0.07, 0.03, 0.11, 0.00, 0.05, 0.01, 0.06, 0.00, 0.06, 0.06],
    "-0.10_logg":    [-0.06, -0.01, -0.02, 0.00, 0.00, -0.01, -0.08, -0.04, -0.11, -0.01, -0.03, -0.01, -0.05, 0.00, -0.05, -0.05],
    "-0.20_logg":    [-0.13, -0.02, -0.05, 0.00, 0.00, -0.02, -0.16, -0.08, -0.20, -0.02, -0.11, -0.04, -0.09, 0.00, -0.09, -0.09],
    "+0.20_FeH":     [0.05, 0.13, 0.08, 0.02, 0.02, 0.20, -0.04, -0.01, -0.02, 0.00, -0.06, 0.07, 0.11, 0.00, 0.11, 0.14],
    "+0.10_FeH":     [0.02, 0.07, -0.01, 0.10, 0.10, 0.09, -0.03, 0.00, -0.01, 0.00, -0.03, 0.03, 0.06, 0.00, 0.06, 0.07],
    "-0.10_FeH":     [0.06, -0.07, -0.08, -0.10, -0.10, -0.01, 0.02, 0.00, 0.04, 0.02, -0.01, 0.05, 0.04, 0.00, 0.04, 0.07],
    "-0.20_FeH":     [0.10, -0.13, -0.16, -0.32, -0.32, 0.00, 0.02, -0.01, 0.05, 0.01, 0.08, 0.07, 0.02, 0.00, 0.02, 0.14],
    "+0.50_xi":      [0.00, -0.05, 0.00, -0.01, -0.01, 0.00, -0.01, 0.00, 0.00, 0.00, 0.00, -0.01, 0.00, 0.00, 0.00, 0.00],
    "+0.25_xi":      [0.00, -0.02, 0.00, 0.00, 0.00, 0.00, -0.01, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00],
    "-0.25_xi":      [0.00, 0.02, 0.00, -0.01, -0.01, 0.00, 0.00, 0.00, 0.01, 0.00, 0.00, 0.01, 0.00, 0.00, 0.00, 0.00],
    "-0.50_xi":      [0.00, 0.04, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.02, 0.00, 0.01, 0.03, 0.00, 0.00, 0.00, 0.00]
}

data_3500K = {
    "Element": ["Fe", "FeH", "C", "H2O", "OH", "Na", "Mg", "Al", "Si", "K", "Ca", "Ti", "V", "Cr", "Mn", "Ni"],
    "+100_Teff":     [-0.18, 0.07, 0.01, 0.07, -0.01, -0.03, -0.20, -0.14, -0.29, 0.07, -0.07, -0.03, 0.10, 0.13, 0, 0],
    "+50_Teff":      [-0.09, 0.03, 0.00, 0.03, 0.00, -0.01, -0.11, -0.07, -0.15, 0.04, -0.03, -0.01, 0.08, 0.08, 0, 0],
    "-50_Teff":      [0.09, -0.03, -0.01, -0.03, 0.01, 0.03, 0.10, 0.06, 0.19, -0.03, 0.02, 0.02, -0.02, -0.02, 0, 0],
    "-100_Teff":     [0.19, -0.06, -0.03, -0.06, 0.01, 0.06, 0.20, 0.11, 0.30, -0.06, 0.04, 0.03, -0.06, -0.04, 0, 0],
    "+0.20_logg":    [0.09, 0.02, 0.01, 0.00, 0.02, 0.05, 0.14, 0.07, 0.27, -0.02, 0.11, 0.03, 0.16, 0.09, 0, 0],
    "+0.10_logg":    [0.05, 0.01, 0.00, 0.00, 0.01, 0.02, 0.07, 0.04, 0.14, -0.01, 0.05, 0.02, 0.08, 0.04, 0, 0],
    "-0.10_logg":    [-0.07, -0.01, -0.02, -0.01, -0.04, 0.00, -0.08, -0.04, -0.10, 0.00, -0.05, -0.02, -0.07, -0.03, 0, 0],
    "-0.20_logg":    [-0.12, -0.01, -0.03, -0.15, -0.07, -0.01, -0.15, -0.08, -0.20, 0.00, -0.11, -0.04, -0.12, -0.07, 0, 0],
    "+0.20_FeH":     [0.00, 0.15, 0.06, 0.02, 0.06, 0.19, -0.03, 0.00, -0.05, 0.01, -0.06, 0.07, 0.12, 0.26, 0, 0],
    "+0.10_FeH":     [0.00, 0.07, -0.02, -0.04, 0.10, 0.09, -0.02, 0.00, -0.02, 0.00, -0.03, 0.03, 0.06, 0.11, 0, 0],
    "-0.10_FeH":     [-0.01, -0.07, -0.09, -0.10, 0.01, -0.06, 0.01, 0.00, 0.06, -0.01, -0.01, 0.01, 0.02, 0.03, 0, 0],
    "-0.20_FeH":     [0.00, -0.15, -0.18, -0.20, -0.15, -0.08, 0.02, 0.01, 0.09, -0.01, 0.00, 0.02, 0.04, 0.14, 0, 0],
    "+0.50_xi":      [0.00, -0.05, 0.00, -0.01, 0.01, 0.00, -0.01, 0.00, 0.00, 0.00, 0.00, -0.01, 0.00, 0.00, 0, 0],
    "+0.25_xi":      [0.00, -0.02, 0.00, -0.01, 0.02, 0.01, 0.00, 0.00, 0.00, 0.00, 0.00, -0.01, 0.00, 0.00, 0, 0],
    "-0.25_xi":      [0.00, 0.02, 0.00, 0.01, -0.04, -0.01, 0.00, 0.01, 0.01, 0.01, 0.00, 0.00, 0.00, 0.00, 0, 0],
    "-0.50_xi":      [-0.01, 0.05, 0.00, 0.00, -0.07, -0.01, 0.00, 0.02, 0.03, 0.02, 0.00, 0.00, 0.00, 0.01, 0, 0]

}

data_3400K = {
    "Element": ["Fe", "FeH", "C", "H2O", "OH", "Na", "Mg", "Al", "Si", "K", "Ca", "Ti", "V", "Cr", "Mn", "Ni"],
    "+100_Teff":     [-0.18, 0.07, 0.01, 0.06, -0.02, -0.01, -0.17, -0.13, -0.21, 0.10, -0.10, -0.03, 0.10, 0, 0, 0],
    "+50_Teff":      [-0.09, 0.04, 0.01, 0.03, -0.01, -0.03, -0.09, -0.06, -0.18, 0.06, -0.04, -0.01, 0.06, 0, 0, 0],
    "-50_Teff":      [0.10, -0.03, 0.00, -0.03, 0.00, 0.03, 0.10, 0.08, 0.20, -0.03, 0.04, 0.02, -0.03, 0, 0, 0],
    "-100_Teff":     [0.19, -0.06, -0.01, -0.05, 0.02, 0.05, 0.21, 0.15, 0.33, -0.07, 0.06, 0.04, -0.07, 0, 0, 0],
    "+0.20_logg":    [0.11, 0.01, 0.02, 0.00, 0.03, 0.04, 0.15, 0.08, 0.33, -0.02, 0.13, 0.03, 0.16, 0, 0, 0],
    "+0.10_logg":    [0.05, 0.00, 0.01, 0.00, 0.02, 0.01, 0.07, 0.04, 0.18, -0.01, 0.06, 0.02, 0.09, 0, 0, 0],
    "-0.10_logg":    [-0.06, 0.00, 0.00, -0.01, 0.00, -0.07, -0.07, -0.03, -0.15, 0.02, -0.06, -0.01, -0.02, 0, 0, 0],
    "-0.20_logg":    [-0.11, 0.00, -0.01, -0.01, -0.08, -0.08, -0.14, -0.07, -0.24, -0.01, -0.13, -0.03, -0.12, 0, 0, 0],
    "+0.20_FeH":     [0.00, 0.15, 0.06, 0.16, 0.06, 0.04, -0.01, 0.00, -0.10, 0.01, -0.06, 0.07, 0.12, 0, 0, 0],
    "+0.10_FeH":     [0.00, 0.09, -0.03, 0.09, 0.00, 0.00, 0.00, 0.01, -0.06, 0.02, -0.03, 0.04, 0.06, 0, 0, 0],
    "-0.10_FeH":     [0.01, -0.07, -0.09, -0.19, -0.01, -0.07, 0.01, -0.01, 0.09, -0.01, 0.03, -0.08, -0.02, 0, 0, 0],
    "-0.20_FeH":     [0.02, -0.15, -0.18, -0.19, 0.02, -0.11, 0.02, -0.03, 0.15, -0.02, 0.06, -0.12, -0.18, 0, 0, 0],
    "+0.50_xi":      [0.00, -0.06, 0.00, -0.01, -0.03, -0.04, -0.01, -0.03, -0.06, 0.00, -0.06, -0.01, 0.00, 0, 0, 0],
    "+0.25_xi":      [0.00, -0.03, 0.00, 0.00, -0.01, -0.03, 0.00, -0.01, -0.02, 0.00, -0.03, 0.00, 0.00, 0, 0, 0],
    "-0.25_xi":      [0.00, 0.03, 0.00, -0.01, 0.01, -0.04, 0.00, 0.01, 0.01, 0.01, 0.00, 0.01, 0.01, 0, 0, 0],
    "-0.50_xi":      [-0.01, 0.06, 0.00, 0.00, 0.02, -0.03, 0.00, 0.02, 0.03, 0.02, 0.00, 0.02, 0.02, 0, 0, 0]

}


data_3300K = {
    "Element": ["Fe", "FeH", "C", "H2O", "OH", "Na", "Mg", "Al", "Si", "K", "Ca", "Ti", "V", "Cr", "Mn", "Ni"],
    "+100_Teff":     [0, 0.08, 0.01, 0.05, -0.01, 0.02, -0.15, -0.14, -0.08, 0.11, -0.12, -0.04, 0, 0, 0, 0],
    "+50_Teff":      [0, 0.04, 0.01, 0.02, -0.01, 0.01, -0.08, -0.06, -0.09, 0.05, -0.06, -0.01, 0, 0, 0, 0],
    "-50_Teff":      [0, -0.03, 0, -0.03, 0.01, -0.02, 0.10, 0.07, 0.35, -0.04, 0.05, 0.02, 0, 0, 0, 0],
    "-100_Teff":     [0, -0.06, 0, -0.05, 0.02, 0.08, 0.22, 0.14, 0.51, -0.10, 0.09, 0.04, 0, 0, 0, 0],
    "+0.20_logg":    [0, 0, 0.02, 0.01, 0.02, 0.06, 0.16, 0.08, 0.63, -0.06, 0.14, 0.03, 0, 0, 0, 0],
    "+0.10_logg":    [0, 0, 0.01, 0, 0.01, 0.02, 0.08, 0.04, 0.35, -0.03, 0.07, 0.01, 0, 0, 0, 0],
    "-0.10_logg":    [0, 0, 0, 0, 0, 0, -0.06, -0.04, -0.09, 0.02, -0.08, -0.01, 0, 0, 0, 0],
    "-0.20_logg":    [0, 0.01, 0, -0.01, -0.01, 0.01, -0.12, -0.08, -0.10, 0.04, -0.15, -0.03, 0, 0, 0, 0],
    "+0.20_FeH":     [0, 0.17, 0.06, 0.14, 0.06, 0.08, 0.02, 0.02, -0.03, 0.03, -0.05, 0.08, 0, 0, 0, 0],
    "+0.10_FeH":     [0, 0.08, -0.02, 0.09, -0.02, 0.04, 0.01, 0, -0.05, 0.02, -0.03, 0.04, 0, 0, 0, 0],
    "-0.10_FeH":     [0, -0.50, -0.08, -0.10, -0.09, -0.03, 0.02, -0.02, 0.25, -0.03, 0.02, -0.07, 0, 0, 0, 0],
    "-0.20_FeH":     [-0.01, -0.16, -0.17, -0.19, -0.17, -0.01, 0.03, -0.04, 0.43, -0.05, 0.06, -0.15, 0, 0, 0, 0],
    "+0.50_xi":      [0, -0.06, 0, -0.01, -0.02, -0.02, 0.02, -0.04, -0.01, -0.03, 0.02, -0.01, 0, 0, 0, 0],
    "+0.25_xi":      [0, -0.03, 0, 0, -0.01, -0.01, 0.01, 0, 0, 0, 0.01, 0, 0, 0, 0, 0],
    "-0.25_xi":      [0, 0.03, 0, 0, 0.01, 0, 0, 0, 0, 0, 0, 0.01, 0, 0, 0, 0],
    "-0.50_xi":      [-0.01, 0.06, 0, 0, 0.02, 0.01, 0, 0.01, -0.01, 0, 0, 0.02, 0, 0, 0, 0]
}


data_3200K = {
    "Element": ["Fe", "FeH", "C", "H2O", "OH", "Na", "Mg", "Al", "Si", "K", "Ca", "Ti", "V", "Cr", "Mn", "Ni"],
    "+100_Teff":     [0, 0.09, 0.02, 0.05, 0.00, 0.00, 0.03, -0.14, -0.15, 0.75, 0.13, -0.16, -0.02, 0, 0, 0],
    "+50_Teff":      [0, 0.05, 0.01, 0.03, 0.00, 0.00, 0.01, -0.07, -0.08, 0.00, 0.06, -0.08, -0.01, 0, 0, 0],
    "-50_Teff":      [0, -0.03, 0.00, -0.03, 0.00, 0.00, -0.02, 0.08, 0.07, 0.52, -0.07, 0.06, 0.02, 0, 0, 0],
    "-100_Teff":     [0, -0.06, 0.00, -0.05, -0.01, -0.01, -0.03, 0.18, 0.13, 0.75, -0.12, 0.11, 0.04, 0, 0, 0],
    "+0.20_logg":    [0, 0.00, 0.01, 0.00, 0.00, 0.00, 0.04, 0.16, 0.07, -0.06, 0.15, 0.01, 0.03, 0, 0, 0],
    "+0.10_logg":    [0, 0.00, 0.01, 0.00, 0.00, 0.00, 0.01, 0.07, 0.04, 0.00, 0.07, 0.01, 0.01, 0, 0, 0],
    "-0.10_logg":    [0, 0.01, 0.01, 0.00, -0.01, -0.01, -0.02, -0.07, -0.11, 0.01, -0.10, 0.01, 0.01, 0, 0, 0],
    "-0.20_logg":    [0.02, 0.02, 0.00, 0.00, 0.01, 0.00, -0.04, -0.13, -0.11, -0.03, -0.17, -0.02, 0.00, 0, 0, 0],
    "+0.20_FeH":     [0, 0.18, 0.08, 0.13, 0.07, 0.54, 0.03, 0.03, -0.06, 0.03, 0.00, 0.08, 0, 0, 0, 0],
    "+0.10_FeH":     [0, 0.09, 0.01, 0.07, 0.05, 0.05, 0.01, 0.02, -0.03, 0.02, 0.00, 0.04, 0, 0, 0, 0],
    "-0.10_FeH":     [0, -0.08, -0.09, -0.10, -0.04, -0.04, -0.04, 0.00, 0.01, -0.15, -0.05, 0.01, -0.08, 0, 0, 0],
    "-0.20_FeH":     [0.01, -0.17, -0.18, -0.19, -0.10, -0.02, -0.02, -0.03, -0.03, 0.01, 0.04, -0.18, 0.02, 0, 0, 0],
    "+0.50_xi":      [0, -0.07, 0.00, 0.00, -0.01, -0.02, -0.02, -0.10, 0.08, -0.05, 0.01, 0.02, -0.08, 0, 0, 0],
    "+0.25_xi":      [0, -0.03, 0.00, 0.00, -0.04, -0.04, -0.01, 0.01, 0.04, -0.10, -0.02, 0.00, 0, 0, 0, 0],
    "-0.25_xi":      [0, 0.03, 0.01, 0.00, 0.00, 0.00, 0.00, 0.03, 0.02, 0.00, 0.04, 0.01, 0, 0, 0, 0],
    "-0.50_xi":      [-0.01, 0.06, 0.01, 0.00, 0.00, 0.00, 0.00, 0.00, -0.18, 0.00, 0.01, 0, 0, 0, 0, 0]
}

# Criando o DataFrame
df_3900K = pd.DataFrame(data_3900K)
df_3800K = pd.DataFrame(data_3800K)
df_3700K = pd.DataFrame(data_3700K)
df_3600K = pd.DataFrame(data_3600K)
df_3500K = pd.DataFrame(data_3500K)
df_3400K = pd.DataFrame(data_3400K)
df_3300K = pd.DataFrame(data_3300K)
df_3200K = pd.DataFrame(data_3200K)


temperature_data = {
    3900: df_3900K,
    3800: df_3800K,
    3700: df_3700K,
    3600: df_3600K,
    3500: df_3500K,
    3400: df_3400K,
    3300: df_3300K,
    3200: df_3200K
}

# Lista dos ajustes disponíveis para cada parâmetro
teff_options = np.array([100, 50, -50, -100])
logg_options = np.array([0.20, 0.10, -0.10, -0.20])
metallicity_options = np.array([0.20, 0.10, -0.10, -0.20])
xi_options = np.array([0.50, 0.25, -0.25, -0.50])


def get_closest_option(value, options):
    """Função para encontrar o valor mais próximo em uma lista de opções."""
    closest_value = options[np.abs(options - value).argmin()]
    return closest_value

def get_uncertainty_atmospheric(temperature, teff, logg, metallicity, xi, element):
    # Aproximação para a temperatura mais próxima
    temperatures = np.array(list(temperature_data.keys()))
    closest_temp = temperatures[np.abs(temperatures - temperature).argmin()]
    df = temperature_data[closest_temp]

    # Aproximação para os ajustes mais próximos
    closest_teff = get_closest_option(int(teff), teff_options)
    closest_logg = get_closest_option(float(logg), logg_options)
    closest_metallicity = get_closest_option(float(metallicity), metallicity_options)
    closest_xi = get_closest_option(float(xi), xi_options)

    # Constrói os nomes das colunas com os ajustes aproximados
    teff_column = f"{closest_teff:+}_Teff"
    logg_column = f"{closest_logg:+.2f}_logg"
    fe_column = f"{closest_metallicity:+.2f}_FeH"
    xi_column = f"{closest_xi:+.2f}_xi"

    # Verifica se todas as colunas calculadas existem no DataFrame
    columns_exist = all(column in df.columns for column in [teff_column, logg_column, fe_column, xi_column])
    if not columns_exist:
        return {"Erro": "Combinação de parâmetros inválida."}

    # Verifica se o elemento é 'all'
    if element.lower() == 'all':
        total_squared_uncertainty = 0
        total_elements = 0

        for index, row in df.iterrows():
            # Calcula as incertezas individuais para cada elemento
            uncertainty_teff = float(row[teff_column])
            uncertainty_logg = float(row[logg_column])
            uncertainty_metallicity = float(row[fe_column])
            uncertainty_xi = float(row[xi_column])

            element_squared_sum = (
                    uncertainty_teff ** 2 +
                    uncertainty_logg ** 2 +
                    uncertainty_metallicity ** 2 +
                    uncertainty_xi ** 2
            )

            total_squared_uncertainty += element_squared_sum
            total_elements += 1  # Contador de elementos

        # Soma quadrática média total para todos os elementos
        total_rms_uncertainty = np.sqrt(total_squared_uncertainty / total_elements)
        return {"Incerteza Propagada": float(total_rms_uncertainty)}

    # Filtra o elemento desejado
    row = df[df["Element"] == element]
    if row.empty:
        return {"Erro": f"Elemento {element} não encontrado para Teff = {closest_temp} K."}

    # Calcula as incertezas individuais para o elemento especificado
    uncertainty_teff = float(row[teff_column].values[0])
    uncertainty_logg = float(row[logg_column].values[0])
    uncertainty_metallicity = float(row[fe_column].values[0])
    uncertainty_xi = float(row[xi_column].values[0])

    rms_uncertainty = np.sqrt(
        uncertainty_teff ** 2 +
        uncertainty_logg ** 2 +
        uncertainty_metallicity ** 2 +
        uncertainty_xi ** 2
    )

    # Retorna um dicionário apenas com as incertezas para o elemento específico
    return {
        "Incerteza_Teff": uncertainty_teff,
        "Incerteza_log(g)": uncertainty_logg,
        "Incerteza_[Fe/H]": uncertainty_metallicity,
        "Incerteza_ξ": uncertainty_xi,
        "Incerteza Propagada": float(rms_uncertainty)
    }

